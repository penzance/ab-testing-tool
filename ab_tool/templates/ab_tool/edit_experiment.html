<!DOCTYPE html>
<html lang="en">
<head>
    {% load staticfiles %}
    <meta charset="utf-8" />
    <title>A/B Testing Tool</title>
    <link rel="stylesheet" href="{% static 'ab_tool/css/bootstrap.min.css' %}" type="text/css"/>
    <link rel="stylesheet" href="{% static 'ab_tool/css/dashboard.css' %}" type="text/css"/>
</head>

<body>
    <div class="container">
        <div class="jumbotron">
            <h2>Experiment "{{experiment.name|default:"Unnamed"}}"</h2>
            <table class="table">
            <tbody>
            <tr>
    
            <td><p>Created: {{experiment.created_on}} | Last updated: {{experiment.updated_on}} </p></td>
            {% if experiment.id and not is_finalized%}
            <td class="text-right nowrap"><a id="delete_experiment_button" href="{% url 'ab:delete_experiment' experiment.id %}" class="btn btn-lg btn-danger">Delete Experiment</a></td>
            {% elif experiment.id and is_finalized %}
            <td class="text-right nowrap"><a id="delete_experiment_button_disabled" class="btn btn-lg btn-danger disabled">Delete Experiment</a></td>
            {% endif %}
            </tr>
            </tbody>
            </table>
        </div>

        {% if experiment.id and is_finalized %}
        <h4 class="text-center nowrap">Experiment has been started.</h4>
        <h5 class="text-center nowrap">Note: Tracks can no longer be deleted or created.</h5>
        {% endif %}

        <form method="post" name="experiment_form"
            {% if experiment.id %} action="{% url 'ab:submit_edit_experiment' experiment.id %}"
            {% else %} action="{% url 'ab:submit_create_experiment'%}" {% endif %}>
        {% csrf_token %}
            <table class="table table-striped">

            <tr align="left">
                <td>
                    <label>Experiment Name</label>
                    <input class="form-control"  type="text" name="name" value="{{ experiment.name }}"/>
                </td>
            </tr>
            <tr>
                <td>
                    <label>Experiment Structure</label>
                    <p>Helpful tip: The assignment method selected is how students will be assigned to tracks. The assignment method defaults to 'Uniform Random'. </p>
                    <div class="row">
                        <div class="col-lg-12">
                            <input type="radio" name="assignment_method" value="{{experiment.UNIFORM_RANDOM}}" {% if experiment.assignment_method == experiment.UNIFORM_RANDOM %} checked="checked" {% endif %}>
                            <label>Uniform Random (Default)</label>
                            <p>Using this method, students are randomly assigned a track, with every track having an equal chance.</p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-12">
                            <input type="radio" name="assignment_method" value="{{experiment.WEIGHTED_PROBABILITY_RANDOM}}" {% if experiment and experiment.assignment_method == experiment.WEIGHTED_PROBABILITY_RANDOM  %} checked="checked" {% endif %}>
                            <label>Weighted Probability Random</label>
                            <p>Using this method, students are randomly assigned a track with a probability calculated by your specified weightings. Note that student assignment is probabilistic and does not guarantee a number of students belonging to a certain track.</p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-12">
                            <input type="radio" name="assignment_method" value="{{experiment.CSV_UPLOAD}}" {% if experiment and periment.assignment_method == experiment.CSV_UPLOAD %} checked="checked" {% endif %}>
                            <label>Upload a CSV file</label>
                            <p>Using this method, you, the admin, will upload a CSV file containing a mapping of which students should be assigned to which track. The tool will provide you a template CSV file to download containing which students have joined the course so far. If more students join the course, the system will alert you to fill out and upload a new CSV file to assign the newly joined students.</p>
                        </div>
                    </div>
                    <br>
                    {% if experiment and experiment.assignment_method == experiment.UNIFORM_RANDOM %}
                        <br>
                        <p>Currently Selected: Uniform Random.</p>
                        <p>Nothing more to do here!</p>
                    {% endif %}
                    {% if experiment and experiment.assignment_method == experiment.WEIGHTED_PROBABILITY_RANDOM %}
                        <br>
                        <p>Currently Selected: Weighted Probability Random.</p>
                        <p>Now assign weightings to tracks.</p>
                        {% if not is_finalized %}
                            <a id="assign_track_weights_button" class="btn btn-lg btn-success"  href="{% url 'ab:track_weights' %}"> Assign Track Probabilities</a>
                        {% else %}
                            <a id="assign_track_weights_button" class="btn btn-lg btn-success disabled"  href=""> Assign Track Probabilities</a>
                        {% endif %}
                    {% endif %}
                    {% if experiment and experiment.assignment_method == experiment.CSV_UPLOAD %}
                        <br>
                        <p>Currently Selected: CSV Upload.</p>
                        <p>Now download the CSV template to complete and upload.</p>
                            <a id="" class="btn btn-lg btn-info"  href=""> Download CSV Template </a>
                            <a id="" class="btn btn-lg btn-success"  href=""> Upload Completed CSV</a>
                    {% endif %}
                </td>
            </tr>

            <tr align="left">
                <td>
                    <label>Experiment Notes</label>
                    <textarea class="form-control" name="notes" rows="3" cols="80" >{{ experiment.notes }}</textarea>
                </td>
            </tr>
            <tr>
                <td><input id="submit_edit_experiment_button" type="submit" name="submit" value="Submit Changes" class="btn btn-lg btn-success submit">
                <a id="cancel_submit_edit_experiment_button" href="{% url 'ab:index' %}" class="btn btn-lg btn-primary">Cancel</a></td>
            </tr>
            </table>
       </form>
    
    <script src="{% static 'ab_tool/js/jquery-1.10.1.min.js' %}"></script>
</body>
</html>

