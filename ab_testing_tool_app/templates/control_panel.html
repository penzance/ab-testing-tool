<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>A/B Testing Tool</title>
    <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
    <link rel="stylesheet" href="../static/css/bootstrap.min.css"  type="text/css"/>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.11.0/themes/smoothness/jquery-ui.css">
    <script src="//code.jquery.com/jquery-1.10.2.js"></script>
    <script src="//code.jquery.com/ui/1.11.0/jquery-ui.js"></script>
    <link rel="stylesheet" href="../static/css/dashboard.css"  type="text/css"/>
</head>

<body>
<div class="container">
      <div class="jumbotron">
          <h2>A/B Testing Control Panel</h2>
        <p>Welcome administrator. Manage your A/B course stages here.</p>
    </div>
      <div id="tabs">
        <ul>
        <li><a href="#tabs-1">Tracks</a></li>
        <li><a href="#tabs-2">A/B Stages</a></li>
        <li><a href="#tabs-3">Course Modules</a></li>
        <li><a href="#tabs-4">Data</a></li>
        </ul>
            <div id="tabs-1">
                 <div class="span8">
                    <p> Create and Edit your A/B Tracks here. You can assign student cohorts to a track <b> only after </b> finalizing your tracks.</p>
                    <br>
                    {% if not is_finalized %}
                    <a class="btn btn-lg btn-success"  href="{% url 'create_track' %}"> Create New Track</a>
                    <a class="btn btn-lg btn-danger" href="{% url 'finalize_tracks' %}"> Finalize Tracks</a>
                    <br>
                    {% else %}
                    <a class="btn btn-lg btn-success disabled"> Create New Track</a>
                    <a class="btn btn-lg btn-danger disabled"> Finalize Tracks</a>
                    <br><br>
                    <h4 class="text-center nowrap">Tracks Are Finalized.</h4>
                    <h5 class="text-center nowrap">Note: Tracks can no longer be deleted or created. Existing tracks can still be edited.</h5>
                    {% endif %}
                    <br>
                    <div class="list-group span4">
                        {% for m in tracks %}
                            <h4><a href="/edit_track/{{m.id}}" class="list-group-item clearfix" id="track_{{m.id}}">
                                    <span><strong>{{m.name}} </strong></span>
                                </a>
                            </h4>
                            <div id="Track_items_{{m.id}}" style="display: none">
                            </div>
                        {% empty %}
                            <br>
                            <p>No Tracks found.</p>
                        {% endfor %}
                    </div>
                </div>
            </div>

            <div id="tabs-2">
                <div class="span8">
                    <p> Create and Edit your A/B stages here. </p>
                    <br>
                    <a class="btn btn-lg btn-success" style="align:left" href="{% url 'create_stage' %}"> Create New Stage</a>
                    <br><br>

                    <div class="list-group span4">
                        {% for t in stages %}
                        <a href="/edit_stage/{{t.id}}" class="list-group-item"><strong>{{t.name}}</strong> - <i>created {{t.created_on}}</i></a>
                        {% endfor %}
                    </div>
                </div>
            </div>

            <div id="tabs-3">
                <div class="span8">
                    <p> See where A/B stages are positioned in your modules here. </p>
                    <br>
                    <div class="list-group span4">
                        {% for m in modules %}
                            <h4><a class="list-group-item" id="module_{{m.id}}"> <strong>Module: {{m.name}}</strong></a></h4>
                            <div id="module_items_{{m.id}}" style="display: none">
                                    <ul class="list-group">
                                        {% for i in m.module_items %}
                                            {% if i.is_stage %}
                                                <a class="list-group-item active">{{i.title}} | <i> Stage</i></a>
                                            {% else %}
                                                <p class="list-group-item">{{i.title|default:"[ Item not titled]"}}</p>
                                            {% endif %}
                                        {% empty %}
                                            <p>No items found in this module.</p>
                                        {% endfor %}
                                    </ul>
                            </div>
                        {% empty %}
                            <p>No modules found.</p>
                        {% endfor %}
                    </div>
                </div>
            </div>

            <div id="tabs-4">
                <div class="span8">
                    <p> Download a CSV file of your A/B testing data here. </p>
                    <br>
                    <a href="/download_data" class="btn btn-lg btn-primary"> Download Data</a>
                </div>
            </div>

      </div>
</div>

<script>
{% for m in tracks %}
$( "#track_" + {{m.id}}).click(function() {
$( "#track_items_" + {{m.id}}).toggle('fast');
});
{% endfor %}

{% for m in modules %}
$( "#module_" + {{m.id}}).click(function() {
$( "#module_items_" + {{m.id}}).toggle('fast');
});
{% endfor %}

$(function() {
$( "#tabs" ).tabs();
});
</script>
</body>
</html>
